# Changelog - 260222

## 260222-17:12:02 - Improve Lisa Session Discovery Across Sockets

### Summary
Expanded socket discovery so tmux-visualiser explicitly and consistently finds Lisa-managed sessions across project sockets.

### Changed
- Added best-effort Lisa CLI discovery via `lisa session list --all-sockets --with-next-action --json`.
- Added process-table discovery for active `tmux -S <socket>` sockets matching Lisa naming patterns.
- Expanded default Lisa socket glob coverage to include `/private/tmp` and legacy `lisa-codex-nosb.sock` paths.
- Updated README to explicitly describe Lisa session discovery behavior.

### Fixed
- Fixed missing Lisa sessions when sockets are active but outside the configured/default glob path.

### Files
- `README.md`
- `src/main.go`
- `src/socket_test.go`
- `src/sockets.go`

### QA Notes
- Verify Lisa sessions are visible when started from different project roots.
- Verify discovery still works when `lisa` is not installed on `PATH`.
- Verify custom `-socket-glob` overrides default fallback globs as expected.

## 260222-19:48:18 - Add Lisa CLI Compatibility Fallback for Session Discovery

### Summary
Made Lisa socket discovery resilient to older `lisa` binaries that reject `--with-next-action`.

### Changed
- Updated Lisa session-list invocation to retry without `--with-next-action` when CLI returns `unknown_flag`.
- Extracted helpers for Lisa invocation, unknown-flag detection, and project-root parsing to keep socket discovery logic testable.

### Fixed
- Fixed `lisa-sockets` discovery errors caused by Lisa/runtime version mismatch where `session list` does not support `--with-next-action`.

### Files
- `src/socket_test.go`
- `src/sockets.go`

### QA Notes
- Verify tmux-visualiser no longer shows `unknown flag: --with-next-action` in discovery errors.
- Verify Lisa sessions still appear when using a newer Lisa build that supports `--with-next-action`.
- Verify fallback path still returns zero errors when `lisa session list --all-sockets --json` succeeds but has no `items`.
